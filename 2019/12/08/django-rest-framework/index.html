
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="WYG">
    <title>django rest_framework - WYG</title>
    <meta name="author" content="王延刚">
    
        <meta name="keywords" content="hexo,javascript,">
    
    
        <link rel="icon" href="https://wangyangang.github.io/assets/images/avatar.jpg">
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"王延刚","sameAs":["https://github.com/wangyangang","https://stackoverflow.com/users/6239464/yangang","https://twitter.com/yangangwang","https://www.facebook.com/yangangwang1991/","mailto:yangangwang1991@gmail.com"],"image":"avatar.jpg"},"articleBody":"\n\n\n认证认证需要有一个认证类，继承 BaseAuthenticatio,其中由两个方法 authenticate 和 authenticate_header.认证成功后在 authenticate 方法里返回用户，这样在 request 里就有了user属性\n1from rest_framework.authentication import BaseAuthenticatio2from rest_framework import exceptions3from restdemo.models import Token, User45class MyAuthentication(BaseAuthentication):6    def authenticate(self, request):7        token = request.GET.get('token')8        try:9            token_info = Token.objects.get(token=token)10        except Exception as e:11            raise exceptions.AuthenticationFailed('认证失败')1213        if token_info:14            try:15                user = User.objects.get(token_obj=token_info)16                ret = (user, token_info)17                return ret18            except Exception:19                raise exceptions.AuthenticationFailed('认证失败')20        else:21            raise exceptions.AuthenticationFailed('认证失败')2223    def authenticate_header(self, val):24        pass\n\n使用自定义的认证类有两种方法\n\n在settings.py里配置.这样每个视图类都会经过该认证。如果某个类不想被认证，可以在类里加一个字段： authentication_classes = [] 即可。\n\n1REST_FRAMEWORK = &#123;2    \"DEFAULT_AUTHENTICATION_CLASSES\": ['utils.authentications.MyAuthentication',]3&#125;\n\n\n直接引用，然后在试图函数里把认证类赋值给视图属性的 authentication_classes 字段\n\n1import MyAuthentication from my_authentication.py2from rest_framework.views import APIVie34class IndexView(APIView):5    authentication_classes = [MyAuthentication]6    def get(self,request):7        pass\n\n权限权限 permission 和认证 authentication 差不多，配置节点是 DEFAULT_PERMISSION_CLASSES ,可以继承 BasePermission ,必须实现 has_permission 方法，返回 True 代表有权限，发挥 False 代表没有权限\n访问频率控制配置节点是 DEFAULT_THROTTLE_CLASSES，可以继承 BaseThrottle,必须实现allow_request方法其内部实现是一下思路：\n1class MyThrottle:2    def __init__(self):3        self.history = None45    def allow_request(self, request, view):6        remote_addr = request.META.get('REMOTE_ADDR')7        ctime = time.time()89        if remote_addr not in VISIT_RECORD:10            VISIT_RECORD[remote_addr] = [ctime, ]11            return True12        history = VISIT_RECORD[remote_addr]13        self.history = history1415        while history and history[-1] &lt; ctime - 10:16            history.pop()1718        if len(history) &lt; 3:19            history.insert(0, ctime)20            return True2122    def wait(self):23        \"\"\"24        还需要等多少秒才能访问25        :return:26        \"\"\"27        ctime = time.time()28        # 剩余多少秒29        rest_time = 10 - (ctime - self.history[-1])30        print(ctime)31        return rest_time\n\n我们不需要自己写算法，只需要继承SimpleRateThrottle即可\n1from rest_framework.throttling import SimpleRateThrottle23class MyThrottle(SimpleRateThrottle):4    scope = 'wyg' # 这是配置文件里DEFAULT_THROTTLE_RATES节点队友的值56    def get_cache_key(self, request, view):7        return self.get_ident(request) # 获取django默认缓存的key，默认get_ident是根据ip进行限制访问次数\n\nsettings.py配置\n1REST_FRAMEWORK = &#123;2    \"DEFAULT_THROTTLE_CLASSES\": ['utils.throttles.MyThrottle', ],3    \"DEFAULT_THROTTLE_RATES\": &#123;'wyg': '3/m'&#125;4&#125;\n\n版本通过URL参数1from rest_framework.versioning import QueryParameterVersioning23# 通过URL参数传递版本: api/user?version=v14# 给视图类的version_class赋值5version_class= QueryParameterVersioning6# 使用的时候需要在settings.py里加上配置节点7# 版本\n\n1\"DEFAULT_VERSION\": 'v1',2'ALLOWED_VERSIONS': ['v1', 'v2'],3\"VERSION_PARAM\": 'version'\n\n通过URL路径1# 通过URL路径传递版本: api/v1/user **推荐使用**2# 使用的时候url要这样配置：3# re_path(r'^api/(?P&lt;version&gt;[v1|v2]+)/students$', StudentView.as_view(), name='students2'),4# 给视图类的version_class赋值5from rest_framework.versioning import URLPathVersioning67version_class = URLPathVersioning\n\n在 request.version 可得到版本信息\n解析器1from rest_framework.parsers import FormParser, JSONParser23class StudentView(APIView):4    parser_classes = [JSONParser, FormParser]5    6    def post(self, request):7    # 通过request.data取数据8        return HttpResponse(request.data['name'])\n\n可通过 DEFAULT_PARSER_CLASSES 进行全局配置\n序列化对queryset进行序列化老方法：\n1roles = Role.objects.all().values('id','name')2ret = json.dumps(list(roles))\n\n使用序列化：\n继承serializers.Serializer1from rest_framework import serializers2from django.http import HttpResponse34class Role(models.Model):5    title = models.CharField('角色名称', max_length=20)6    7class Group(models.Model):8    title = models.CharField('组名', max_length=20)9    10class User(models.Model):11    USER_TYPE = (12        (1, '普通用户'),13        (2, 'VIP用户')14    )15    username = models.CharField('用户名', max_length=20, unique=True)16    password = models.CharField('密码', max_length=20)17    type = models.PositiveIntegerField('用户类型', choices=USER_TYPE)18    role = models.ManyToManyField(to=Role)19    group = models.ForeignKey(Group, on_delete=models.CASCADE, null=True, blank=True)20    21class UserSerializer(serializers.Serializer):22    username = serializers.CharField()23    user_type = serializers.CharField(source='type')24    user_type_display = serializers.CharField(source='get_type_display')25    group = serializers.CharField(source='group.title')26    role = serializers.SerializerMethodField()27    28    def get_role(self, row):29        row_object_list = row.role.all()30        ret = []31        for item in row_object_list:32            ret.append(&#123;'id': item.id, 'title': item.title&#125;)33    return ret34    35# 视图方法36class StudentView(APIView):37    def get(self, request, *args, **kwargs):38        users = User.objects.all()39        ret = UserSerializer(instance=users, many=True)40        ret = json.dumps(ret.data)41        return HttpResponse(ret)\n\n继承serializers.ModelSerializer1class UserSerializer2(serializers.ModelSerializer):2    user_type = serializers.CharField(source='type')3    group = serializers.CharField(source='group.title')4    role = serializers.SerializerMethodField()56    class Meta:7        model = User8        # 需要把用到的所有字段都写上。从数据库取出来直接用的字段，不需要在类的字段里定义，需要做处理的可以写在类的字段里，并写在Meta的fields里。这样比使用默认serializer省事。9        fields = ['id', 'username', 'password', 'user_type', 'group', 'role']1011    def get_role(self, row):12        ret = []13        roles = row.role.all()14        for role in roles:15            ret.append(&#123;'id': role.id, 'title': role.title&#125;)16        return ret\n\n最简单的就是下面：1class UserSerializer(serializers.ModelSerializer):2    class Meta:3        model = User4        fields = '__all__'5        depth = 1 # depth代表层数\n\n还可以生成链接1re_path(r'^api/group/(?P&lt;pk&gt;\\d+)$', GroupView.as_view(), name='gp'),23class UserSerializer3(serializers.ModelSerializer):4    group = serializers.HyperlinkedIdentityField(view_name='gp', lookup_url_kwarg='pk', lookup_field='group_id')56    class Meta:7        model = User8        fields = ['id', 'username', 'password', 'group']9# 这样在返回数据的时候，字段group会生成一个url，根据url传进来的pk值进行拼接\n\n验证1class RoleSerializer(serializers.Serializer):2    title = serializers.CharField(error_messages=&#123;'required': 'title不能为空'&#125;)345class RoleView(APIView):6    def post(self, request):7        ser = RoleSerializer(data=request.data)8        if ser.is_valid():9            print(ser.validated_data['title'])10        else:11            print(ser.errors)1213        return HttpResponse('role api')\n\n分页使用rest_framework.PageNumberPagination在配置文件里定义每页显示几条&quot;PAGE_SIZE&quot;: 3\n1class PageSerializer(serializers.ModelSerializer):2    class Meta:3        model = Role4        fields = '__all__'567class PagerView(APIView):8    def get(self, request):9        from rest_framework.pagination import PageNumberPagination10        from rest_framework.response import Response1112        roles = Role.objects.all()1314        pg = PageNumberPagination()1516        page_roles = pg.paginate_queryset(queryset=roles, request=request, view=self)1718        ser = PageSerializer(instance=page_roles, many=True)1920        return Response(ser.data) # 用rest_framework的response可以直接返回，并且可以在浏览器预览数据，格式比较美观\n\n\n还可以直接用 PageNumberPagination 对象返回：return pg.get_paginated_response(ser.data)这样的返回数据包含：总共有多少条数据，上一页的 url 和下一页的 url\n\n1&#123;2    \"count\": 7,3    \"next\": \"http://127.0.0.1:8000/api/pages?page=3\",4    \"previous\": \"http://127.0.0.1:8000/api/pages\",5    \"results\": [6        &#123;7            \"id\": 3,8            \"title\": \"校长\"9        &#125;,10        &#123;11            \"id\": 4,12            \"title\": \"班长\"13        &#125;14    ]15&#125;\n\nurl：url: api/pages默认显示第一页，可以通过 page 参数指定显示的页码url: api/pages?page=2\n继承PageNumberPagination进行自定义1class CustomPageNumberPagination(PageNumberPagination):2    page_size_query_param = 'size' # 配置可通过url传递每页显示几条数据的参数名 http://127.0.0.1:8000/api/pages?page=1&amp;size=43    page_size = 2  # 每页显示几条4    max_page_size = 5  # 每页最多显示几条5    page_query_param = 'page'   # 请求第几页的时候，url里使用的参数名\n\n使用rest_framework的LimitOffsetPaginationurl使用api/pages?limit=1&amp;offset=2\n继承LimitOffsetPagination进行自定义这会对url的的页码参数进行加密\n路由1re_path(r'^api/views$', ViewsView.as_view(&#123;'get':'list','post':'create'&#125;)),2re_path(r'^api/views/(?P&lt;pk&gt;\\d+)$', ViewsView.as_view(&#123;'get': 'retrieve', 'delete': 'destroy', 'put': 'update', 'patch': 'partial_update'&#125;), name='views'),34from rest_framework.viewsets import ModelViewSet56class PageSerializer(serializers.ModelSerializer):7    class Meta:8        model = Role9        fields = '__all__'10        11# 在一下视图函数只需三行代码即可12class ViewsView(ModelViewSet):13    queryset = Role.objects.all()14    serializer_class = PageSerializer15    pagination_class = PageNumberPagination16`\n\n这样写了以后，访问api/views 就可以进行增加和查询全部访问api/views/1 就可以单个查询，单个修改，单个删除，单个局部更新和单个全部更新\n跟简单的是：\n1from rest_framework import routers23router = routers.DefaultRouter()4router.register(r'views', ViewsView)56re_path(r'^api/', include(router.urls))\n\n\n这样写的话，直接会帮我们生成路由，只需访问 api/views 或 api/views/1 即可\n\n视图参见路由里的那个视图\n渲染器可以在视图里写renderer_classes字段，也可以在全局配置 DEFAULT_RENDERER_CLASSES需要把rest_framework加入到install_apps配置里\n1from rest_framework.renderers import JSONRenderer, BrowsableAPIRenderer, AdminRenderer, HTMLFormRenderer2class RenderView(APIView):3    renderer_classes = [JSONRenderer, BrowsableAPIRenderer]4    def get(self, request):5        roles = Role.objects.all()6        pg = CustomCursorPagination()7        pg_roles = pg.paginate_queryset(queryset=roles, request=request, view=self)8        se = PageSerializer(instance=roles, many=True)9        return Response(se.data)","dateCreated":"2019-12-08T12:11:06+08:00","dateModified":"2019-12-10T00:12:06+08:00","datePublished":"2019-12-08T12:11:06+08:00","description":"django rest_framework","headline":"django rest_framework","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"/https:/wangyangang.github.io/2019/12/08/django-rest-framework/"},"publisher":{"@type":"Organization","name":"王延刚","sameAs":["https://github.com/wangyangang","https://stackoverflow.com/users/6239464/yangang","https://twitter.com/yangangwang","https://www.facebook.com/yangangwang1991/","mailto:yangangwang1991@gmail.com"],"image":"avatar.jpg","logo":{"@type":"ImageObject","url":"avatar.jpg"}},"url":"/https:/wangyangang.github.io/2019/12/08/django-rest-framework/","keywords":"django, rest_framwork"}</script>
    <meta name="description" content="django rest_framework">
<meta name="keywords" content="django,rest_framwork">
<meta property="og:type" content="blog">
<meta property="og:title" content="django rest_framework">
<meta property="og:url" content="https:&#x2F;&#x2F;wangyangang.github.io&#x2F;2019&#x2F;12&#x2F;08&#x2F;django-rest-framework&#x2F;index.html">
<meta property="og:site_name" content="WYG">
<meta property="og:description" content="django rest_framework">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-12-09T16:12:06.160Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@yangangwang">
    
    
        
    
    
        <meta property="og:image" content="https://wangyangang.github.io/assets/images/avatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/all.css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/assets/css/thumbs.css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    

    

    
        
            <link rel="stylesheet" href="/assets/css/gitalk.css">
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
        WYG
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="avatar.jpg"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="avatar.jpg"/>
                </a>
                <h4 class="sidebar-profile-name">王延刚</h4>
                
                    <h5 class="sidebar-profile-bio"><p>graduated from 山东科技大学 in 2015,python back-end developer,open source contributor,and dota2 player.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/"
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="Search"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/wangyangang" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://stackoverflow.com/users/6239464/yangang" target="_blank" rel="noopener" title="Stack Overflow">
                    
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://twitter.com/yangangwang" target="_blank" rel="noopener" title="Twitter">
                    
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.facebook.com/yangangwang1991/" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:yangangwang1991@gmail.com" target="_blank" rel="noopener" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            django rest_framework
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-12-08T12:11:06+08:00">
	
		    Dec 08, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/django/">django</a>, <a class="category-link" href="/categories/django/rest-framework/">rest_framework</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <!-- excerpt -->
<h1 id="table-of-contents">Table of Contents</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#认证"><span class="toc-text">认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#权限"><span class="toc-text">权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#访问频率控制"><span class="toc-text">访问频率控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#版本"><span class="toc-text">版本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#通过URL参数"><span class="toc-text">通过URL参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通过URL路径"><span class="toc-text">通过URL路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解析器"><span class="toc-text">解析器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#序列化"><span class="toc-text">序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#继承serializers-Serializer"><span class="toc-text">继承serializers.Serializer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#继承serializers-ModelSerializer"><span class="toc-text">继承serializers.ModelSerializer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最简单的就是下面："><span class="toc-text">最简单的就是下面：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#还可以生成链接"><span class="toc-text">还可以生成链接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#验证"><span class="toc-text">验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分页"><span class="toc-text">分页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用rest-framework-PageNumberPagination"><span class="toc-text">使用rest_framework.PageNumberPagination</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#继承PageNumberPagination进行自定义"><span class="toc-text">继承PageNumberPagination进行自定义</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用rest-framework的LimitOffsetPagination"><span class="toc-text">使用rest_framework的LimitOffsetPagination</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#继承LimitOffsetPagination进行自定义"><span class="toc-text">继承LimitOffsetPagination进行自定义</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#路由"><span class="toc-text">路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#视图"><span class="toc-text">视图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#渲染器"><span class="toc-text">渲染器</span></a></li></ol>

<h2 id="认证"><a href="#认证" class="headerlink" title="认证"></a>认证</h2><p>认证需要有一个认证类，继承 <code>BaseAuthenticatio</code>,其中由两个方法 <code>authenticate</code> 和 <code>authenticate_header</code>.认证成功后在 <code>authenticate</code> 方法里返回用户，这样在 <code>request</code> 里就有了user属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.authentication <span class="keyword">import</span> BaseAuthenticatio</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> exceptions</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> restdemo.models <span class="keyword">import</span> Token, User</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyAuthentication</span><span class="params">(BaseAuthentication)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate</span><span class="params">(self, request)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        token = request.GET.get(<span class="string">'token'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">try</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">            token_info = Token.objects.get(token=token)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(<span class="string">'认证失败'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> token_info:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">try</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">                user = User.objects.get(token_obj=token_info)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">                ret = (user, token_info)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">return</span> ret</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">except</span> Exception:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">raise</span> exceptions.AuthenticationFailed(<span class="string">'认证失败'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(<span class="string">'认证失败'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate_header</span><span class="params">(self, val)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">pass</span></span></pre></td></tr></table></figure>

<p>使用自定义的认证类有两种方法</p>
<ol>
<li>在settings.py里配置.这样每个视图类都会经过该认证。如果某个类不想被认证，可以在类里加一个字段： <code>authentication_classes = []</code> 即可。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="string">"DEFAULT_AUTHENTICATION_CLASSES"</span>: [<span class="string">'utils.authentications.MyAuthentication'</span>,]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<ol>
<li>直接引用，然后在试图函数里把认证类赋值给视图属性的 <code>authentication_classes</code> 字段</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MyAuthentication <span class="keyword">from</span> my_authentication.py</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIVie</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexView</span><span class="params">(APIView)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    authentication_classes = [MyAuthentication]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">pass</span></span></pre></td></tr></table></figure>

<h2 id="权限"><a href="#权限" class="headerlink" title="权限"></a>权限</h2><p>权限 <code>permission</code> 和认证 <code>authentication</code> 差不多，<br>配置节点是 <code>DEFAULT_PERMISSION_CLASSES</code> ,<br>可以继承 <code>BasePermission</code> ,必须实现 <code>has_permission</code> 方法，返回 <code>True</code> 代表有权限，发挥 <code>False</code> 代表没有权限</p>
<h2 id="访问频率控制"><a href="#访问频率控制" class="headerlink" title="访问频率控制"></a>访问频率控制</h2><p>配置节点是 <code>DEFAULT_THROTTLE_CLASSES</code>，<br>可以继承 <code>BaseThrottle</code>,<br>必须实现<code>allow_request</code>方法<br>其内部实现是一下思路：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThrottle</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        self.history = <span class="literal">None</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">allow_request</span><span class="params">(self, request, view)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        remote_addr = request.META.get(<span class="string">'REMOTE_ADDR'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        ctime = time.time()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> remote_addr <span class="keyword">not</span> <span class="keyword">in</span> VISIT_RECORD:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">            VISIT_RECORD[remote_addr] = [ctime, ]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        history = VISIT_RECORD[remote_addr]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        self.history = history</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">while</span> history <span class="keyword">and</span> history[<span class="number">-1</span>] &lt; ctime - <span class="number">10</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">            history.pop()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> len(history) &lt; <span class="number">3</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">            history.insert(<span class="number">0</span>, ctime)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wait</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">        <span class="string">"""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="string">        还需要等多少秒才能访问</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="string">        :return:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="string">        """</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">        ctime = time.time()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 剩余多少秒</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">        rest_time = <span class="number">10</span> - (ctime - self.history[<span class="number">-1</span>])</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">        print(ctime)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> rest_time</span></pre></td></tr></table></figure>

<p>我们不需要自己写算法，只需要继承SimpleRateThrottle即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.throttling <span class="keyword">import</span> SimpleRateThrottle</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThrottle</span><span class="params">(SimpleRateThrottle)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    scope = <span class="string">'wyg'</span> <span class="comment"># 这是配置文件里DEFAULT_THROTTLE_RATES节点队友的值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_cache_key</span><span class="params">(self, request, view)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> self.get_ident(request) <span class="comment"># 获取django默认缓存的key，默认get_ident是根据ip进行限制访问次数</span></span></pre></td></tr></table></figure>

<p>settings.py配置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="string">"DEFAULT_THROTTLE_CLASSES"</span>: [<span class="string">'utils.throttles.MyThrottle'</span>, ],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="string">"DEFAULT_THROTTLE_RATES"</span>: &#123;<span class="string">'wyg'</span>: <span class="string">'3/m'</span>&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h2 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h2><h3 id="通过URL参数"><a href="#通过URL参数" class="headerlink" title="通过URL参数"></a>通过URL参数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.versioning <span class="keyword">import</span> QueryParameterVersioning</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过URL参数传递版本: api/user?version=v1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 给视图类的version_class赋值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">version_class= QueryParameterVersioning</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用的时候需要在settings.py里加上配置节点</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 版本</span></span></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="string">"DEFAULT_VERSION"</span>: <span class="string">'v1'</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="string">'ALLOWED_VERSIONS'</span>: [<span class="string">'v1'</span>, <span class="string">'v2'</span>],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="string">"VERSION_PARAM"</span>: <span class="string">'version'</span></span></pre></td></tr></table></figure>

<h3 id="通过URL路径"><a href="#通过URL路径" class="headerlink" title="通过URL路径"></a>通过URL路径</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过URL路径传递版本: api/v1/user **推荐使用**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用的时候url要这样配置：</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># re_path(r'^api/(?P&lt;version&gt;[v1|v2]+)/students$', StudentView.as_view(), name='students2'),</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 给视图类的version_class赋值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.versioning <span class="keyword">import</span> URLPathVersioning</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">version_class = URLPathVersioning</span></pre></td></tr></table></figure>

<p>在 <code>request.version</code> 可得到版本信息</p>
<h2 id="解析器"><a href="#解析器" class="headerlink" title="解析器"></a>解析器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.parsers <span class="keyword">import</span> FormParser, JSONParser</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentView</span><span class="params">(APIView)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    parser_classes = [JSONParser, FormParser]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, request)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 通过request.data取数据</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> HttpResponse(request.data[<span class="string">'name'</span>])</span></pre></td></tr></table></figure>

<p>可通过 <code>DEFAULT_PARSER_CLASSES</code> 进行全局配置</p>
<h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><p>对queryset进行序列化<br>老方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">roles = Role.objects.all().values(<span class="string">'id'</span>,<span class="string">'name'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">ret = json.dumps(list(roles))</span></pre></td></tr></table></figure>

<p>使用序列化：</p>
<h3 id="继承serializers-Serializer"><a href="#继承serializers-Serializer" class="headerlink" title="继承serializers.Serializer"></a>继承serializers.Serializer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Role</span><span class="params">(models.Model)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    title = models.CharField(<span class="string">'角色名称'</span>, max_length=<span class="number">20</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Group</span><span class="params">(models.Model)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    title = models.CharField(<span class="string">'组名'</span>, max_length=<span class="number">20</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(models.Model)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    USER_TYPE = (</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        (<span class="number">1</span>, <span class="string">'普通用户'</span>),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        (<span class="number">2</span>, <span class="string">'VIP用户'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    username = models.CharField(<span class="string">'用户名'</span>, max_length=<span class="number">20</span>, unique=<span class="literal">True</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    password = models.CharField(<span class="string">'密码'</span>, max_length=<span class="number">20</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    type = models.PositiveIntegerField(<span class="string">'用户类型'</span>, choices=USER_TYPE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    role = models.ManyToManyField(to=Role)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">    group = models.ForeignKey(Group, on_delete=models.CASCADE, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">    username = serializers.CharField()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">    user_type = serializers.CharField(source=<span class="string">'type'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">    user_type_display = serializers.CharField(source=<span class="string">'get_type_display'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">    group = serializers.CharField(source=<span class="string">'group.title'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">    role = serializers.SerializerMethodField()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_role</span><span class="params">(self, row)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">        row_object_list = row.role.all()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">        ret = []</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> row_object_list:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">            ret.append(&#123;<span class="string">'id'</span>: item.id, <span class="string">'title'</span>: item.title&#125;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">return</span> ret</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 视图方法</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentView</span><span class="params">(APIView)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">        users = User.objects.all()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">        ret = UserSerializer(instance=users, many=<span class="literal">True</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">        ret = json.dumps(ret.data)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> HttpResponse(ret)</span></pre></td></tr></table></figure>

<h3 id="继承serializers-ModelSerializer"><a href="#继承serializers-ModelSerializer" class="headerlink" title="继承serializers.ModelSerializer"></a>继承serializers.ModelSerializer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserSerializer2</span><span class="params">(serializers.ModelSerializer)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    user_type = serializers.CharField(source=<span class="string">'type'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    group = serializers.CharField(source=<span class="string">'group.title'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    role = serializers.SerializerMethodField()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        model = User</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 需要把用到的所有字段都写上。从数据库取出来直接用的字段，不需要在类的字段里定义，需要做处理的可以写在类的字段里，并写在Meta的fields里。这样比使用默认serializer省事。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        fields = [<span class="string">'id'</span>, <span class="string">'username'</span>, <span class="string">'password'</span>, <span class="string">'user_type'</span>, <span class="string">'group'</span>, <span class="string">'role'</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_role</span><span class="params">(self, row)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        ret = []</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        roles = row.role.all()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> role <span class="keyword">in</span> roles:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">            ret.append(&#123;<span class="string">'id'</span>: role.id, <span class="string">'title'</span>: role.title&#125;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> ret</span></pre></td></tr></table></figure>

<h3 id="最简单的就是下面："><a href="#最简单的就是下面：" class="headerlink" title="最简单的就是下面："></a>最简单的就是下面：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        model = User</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        fields = <span class="string">'__all__'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        depth = <span class="number">1</span> <span class="comment"># depth代表层数</span></span></pre></td></tr></table></figure>

<h3 id="还可以生成链接"><a href="#还可以生成链接" class="headerlink" title="还可以生成链接"></a>还可以生成链接</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">re_path(<span class="string">r'^api/group/(?P&lt;pk&gt;\d+)$'</span>, GroupView.as_view(), name=<span class="string">'gp'</span>),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserSerializer3</span><span class="params">(serializers.ModelSerializer)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    group = serializers.HyperlinkedIdentityField(view_name=<span class="string">'gp'</span>, lookup_url_kwarg=<span class="string">'pk'</span>, lookup_field=<span class="string">'group_id'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        model = User</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        fields = [<span class="string">'id'</span>, <span class="string">'username'</span>, <span class="string">'password'</span>, <span class="string">'group'</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这样在返回数据的时候，字段group会生成一个url，根据url传进来的pk值进行拼接</span></span></pre></td></tr></table></figure>

<h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RoleSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    title = serializers.CharField(error_messages=&#123;<span class="string">'required'</span>: <span class="string">'title不能为空'</span>&#125;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RoleView</span><span class="params">(APIView)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, request)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        ser = RoleSerializer(data=request.data)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> ser.is_valid():</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">            print(ser.validated_data[<span class="string">'title'</span>])</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">            print(ser.errors)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">'role api'</span>)</span></pre></td></tr></table></figure>

<h2 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h2><h3 id="使用rest-framework-PageNumberPagination"><a href="#使用rest-framework-PageNumberPagination" class="headerlink" title="使用rest_framework.PageNumberPagination"></a>使用rest_framework.PageNumberPagination</h3><p>在配置文件里定义每页显示几条<br><code>&quot;PAGE_SIZE&quot;: 3</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PageSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        model = Role</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        fields = <span class="string">'__all__'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PagerView</span><span class="params">(APIView)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">from</span> rest_framework.pagination <span class="keyword">import</span> PageNumberPagination</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        roles = Role.objects.all()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        pg = PageNumberPagination()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        page_roles = pg.paginate_queryset(queryset=roles, request=request, view=self)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        ser = PageSerializer(instance=page_roles, many=<span class="literal">True</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> Response(ser.data) <span class="comment"># 用rest_framework的response可以直接返回，并且可以在浏览器预览数据，格式比较美观</span></span></pre></td></tr></table></figure>

<blockquote>
<p>还可以直接用 <code>PageNumberPagination</code> 对象返回：<br><code>return pg.get_paginated_response(ser.data)</code><br>这样的返回数据包含：总共有多少条数据，上一页的 <code>url</code> 和下一页的 <code>url</code></p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="attr">"count"</span>: <span class="number">7</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="attr">"next"</span>: <span class="string">"http://127.0.0.1:8000/api/pages?page=3"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="attr">"previous"</span>: <span class="string">"http://127.0.0.1:8000/api/pages"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="attr">"results"</span>: [</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">            <span class="attr">"id"</span>: <span class="number">3</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">            <span class="attr">"title"</span>: <span class="string">"校长"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        &#125;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">            <span class="attr">"id"</span>: <span class="number">4</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">            <span class="attr">"title"</span>: <span class="string">"班长"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p><code>url</code>：<br><code>url: api/pages</code><br>默认显示第一页，可以通过 <code>page</code> 参数指定显示的页码<br><code>url: api/pages?page=2</code></p>
<h4 id="继承PageNumberPagination进行自定义"><a href="#继承PageNumberPagination进行自定义" class="headerlink" title="继承PageNumberPagination进行自定义"></a>继承PageNumberPagination进行自定义</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomPageNumberPagination</span><span class="params">(PageNumberPagination)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    page_size_query_param = <span class="string">'size'</span> <span class="comment"># 配置可通过url传递每页显示几条数据的参数名 http://127.0.0.1:8000/api/pages?page=1&amp;size=4</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    page_size = <span class="number">2</span>  <span class="comment"># 每页显示几条</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    max_page_size = <span class="number">5</span>  <span class="comment"># 每页最多显示几条</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    page_query_param = <span class="string">'page'</span>   <span class="comment"># 请求第几页的时候，url里使用的参数名</span></span></pre></td></tr></table></figure>

<h3 id="使用rest-framework的LimitOffsetPagination"><a href="#使用rest-framework的LimitOffsetPagination" class="headerlink" title="使用rest_framework的LimitOffsetPagination"></a>使用rest_framework的LimitOffsetPagination</h3><p>url使用api/pages?limit=1&amp;offset=2</p>
<h4 id="继承LimitOffsetPagination进行自定义"><a href="#继承LimitOffsetPagination进行自定义" class="headerlink" title="继承LimitOffsetPagination进行自定义"></a>继承LimitOffsetPagination进行自定义</h4><p>这会对url的的页码参数进行加密</p>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">re_path(<span class="string">r'^api/views$'</span>, ViewsView.as_view(&#123;<span class="string">'get'</span>:<span class="string">'list'</span>,<span class="string">'post'</span>:<span class="string">'create'</span>&#125;)),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">re_path(<span class="string">r'^api/views/(?P&lt;pk&gt;\d+)$'</span>, ViewsView.as_view(&#123;<span class="string">'get'</span>: <span class="string">'retrieve'</span>, <span class="string">'delete'</span>: <span class="string">'destroy'</span>, <span class="string">'put'</span>: <span class="string">'update'</span>, <span class="string">'patch'</span>: <span class="string">'partial_update'</span>&#125;), name=<span class="string">'views'</span>),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PageSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        model = Role</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        fields = <span class="string">'__all__'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在一下视图函数只需三行代码即可</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewsView</span><span class="params">(ModelViewSet)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    queryset = Role.objects.all()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    serializer_class = PageSerializer</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    pagination_class = PageNumberPagination</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">`</span></pre></td></tr></table></figure>

<p>这样写了以后，访问api/views 就可以进行增加和查询全部<br>访问api/views/1 就可以单个查询，单个修改，单个删除，单个局部更新和单个全部更新</p>
<p>跟简单的是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> routers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">router = routers.DefaultRouter()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">router.register(<span class="string">r'views'</span>, ViewsView)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">re_path(<span class="string">r'^api/'</span>, include(router.urls))</span></pre></td></tr></table></figure>

<blockquote>
<p><strong>这样写的话，直接会帮我们生成路由，只需访问 <code>api/views</code> 或 <code>api/views/1</code> 即可</strong></p>
</blockquote>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p>参见路由里的那个视图</p>
<h2 id="渲染器"><a href="#渲染器" class="headerlink" title="渲染器"></a>渲染器</h2><p>可以在视图里写renderer_classes字段，也可以在全局配置 <code>DEFAULT_RENDERER_CLASSES</code><br>需要把rest_framework加入到install_apps配置里</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.renderers <span class="keyword">import</span> JSONRenderer, BrowsableAPIRenderer, AdminRenderer, HTMLFormRenderer</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RenderView</span><span class="params">(APIView)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    renderer_classes = [JSONRenderer, BrowsableAPIRenderer]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        roles = Role.objects.all()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        pg = CustomCursorPagination()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        pg_roles = pg.paginate_queryset(queryset=roles, request=request, view=self)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        se = PageSerializer(instance=roles, many=<span class="literal">True</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> Response(se.data)</span></pre></td></tr></table></figure>
            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/django/" rel="tag">django</a> <a class="tag tag--primary tag--small t-link" href="/tags/rest-framwork/" rel="tag">rest_framwork</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/12/08/django-template/"
                    data-tooltip="django模板"
                    aria-label="PREVIOUS: django模板"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/12/08/docker/"
                    data-tooltip="docker基本操作"
                    aria-label="NEXT: docker基本操作"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#gitalk"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 王延刚. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/12/08/django-template/"
                    data-tooltip="django模板"
                    aria-label="PREVIOUS: django模板"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/12/08/docker/"
                    data-tooltip="docker基本操作"
                    aria-label="NEXT: docker基本操作"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#gitalk"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="avatar.jpg"/>
        
            <h4 id="about-card-name">王延刚</h4>
        
            <div id="about-card-bio"><p>graduated from 山东科技大学 in 2015,python back-end developer,open source contributor,and dota2 player.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>web developer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Shanghai
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="/assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-admin/"
                            aria-label=": django-admin的使用"
                        >
                            <h3 class="media-heading">django-admin的使用</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>django-admin是一个用来管理django站点后台数据库的应用，是django自带的。<br>我们用pycharm创建django应用的时候，默认就把admin这个应用加入到settngs.py的installed app里了。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-cookie-session/"
                            aria-label=": Django Cookie Session 操作"
                        >
                            <h3 class="media-heading">Django Cookie Session 操作</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc --></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-form-component/"
                            aria-label=": django form 组件"
                        >
                            <h3 class="media-heading">django form 组件</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc --></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-pagination/"
                            aria-label=": django分页"
                        >
                            <img class="media-image" src="https://wangyangang.github.io/2019/12/08/django-pagination/分页.jpeg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-pagination/"
                            aria-label=": django分页"
                        >
                            <h3 class="media-heading">django分页</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>Django提供了数据分页的类，这些类被定义在django/core/paginator.py中。 类Paginator用于对列进行一页n条数据的分页运算。类Page用于表示第m页的数据。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-primary/"
                            aria-label=": django的安装和使用"
                        >
                            <img class="media-image" src="https://wangyangang.github.io/2019/12/08/django-primary/django.jpeg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-primary/"
                            aria-label=": django的安装和使用"
                        >
                            <h3 class="media-heading">django的安装和使用</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>Python下有许多款不同的 Web 框架。Django是重量级选手中最有代表性的一位。许多成功的网站和APP都基于Django。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-models/"
                            aria-label=": django模型models的使用"
                        >
                            <img class="media-image" src="https://wangyangang.github.io/2019/12/08/django-models/orm.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-models/"
                            aria-label=": django模型models的使用"
                        >
                            <h3 class="media-heading">django模型models的使用</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>在MVC框架中的Model模块中都包括ORM:实现了数据模型与数据库的解耦。只需要面向对象编程，不需要面向数据库编写代码。在Model中定义的类，通过ORM与数据表对应，对象的属性体现对象间的关系，这种关系也被映射到数据表中。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-template/"
                            aria-label=": django模板"
                        >
                            <h3 class="media-heading">django模板</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->

<p>这里只介绍模板里的高级用法：自定义标签和过滤器</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/django-rest-framework/"
                            aria-label=": django rest_framework"
                        >
                            <h3 class="media-heading">django rest_framework</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>django rest_framework</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/docker/"
                            aria-label=": docker基本操作"
                        >
                            <img class="media-image" src="https://wangyangang.github.io/2019/12/08/docker/docker.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/docker/"
                            aria-label=": docker基本操作"
                        >
                            <h3 class="media-heading">docker基本操作</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>去年开始接触docker容器，当然只是处于一个观望的状态。今年有幸开始进行浅尝，特将过程记录下来，供自己以及将要使用docker的小伙伴们参考。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://wangyangang.github.io/2019/12/08/mysql-primary/"
                            aria-label=": mysql基础知识"
                        >
                            <h3 class="media-heading">mysql基础知识</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 8, 2019
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc --></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="no post found"
                data-message-one="1 post found"
                data-message-other="{n} posts found">
                22 posts found
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/thumbs.js"></script>
<script src="/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'https://wangyangang.github.io/2019/12/08/django-rest-framework/';
              
            this.page.identifier = '2019/12/08/django-rest-framework/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'wangyangang-blog';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    



    <script src="/assets/js/moment-with-locales.js"></script>
    <script src="/assets/js/algoliasearch.js"></script>
    <script>
      var algoliaClient = algoliasearch('0MOABRJ7QA', '58f5d9684e76f1a46af62e9dd3449aea');
      var algoliaIndex = algoliaClient.initIndex('blog-index');
    </script>


    </body>
</html>
